-- Ticket 436061
-- Giuliano em 06/08/2024
-- Inserir a tabela no EXISTS da view NAGV_EMITENTEITWORKS para ir a emb = UN

ALTER SESSION SET CURRENT_SCHEMA = CONSINCO;

CREATE TABLE CONSINCO.NAGT_TKT436061 AS

SELECT *  
  FROM MAP_PRODCODIGO X 
 WHERE SEQPRODUTO IN (240223,240240,258925,258928,259156,125123,140706,410922,411158,434256,711807,787987,788007,837811,892599,892605,236904,236911,261117,261118,261120,261121,191135,191142,191180,707824,188647,240412,258358,361583,683135,854146,219431,253613,253615,259669,259670,259671,259672,259677,259678,259679,259680,259681,259701,259702,259709,259710,259711,259713,259714,259717,259718,259719,259720,259722,259723,259724,259725,259726,259741,259742,259744,259752,259754,259755,259762,214074,214075,214078,214079,214080,214081,261446,261448,261450,262566,262719,232138,232139,232140,232141,232142,232143,234191,239612,589444,174251,174534,189354,189361,189415,189576,206993,206994,207028,207029,207030,208692,218897,218914,223041,223043,225085,226650,227571,227572,227576,227595,227596,231559,231561,231563,245045,247978,247980,252501,253795,254045,256526,256558,256559,256572,256573,258285,258316,258317,259779,261775,261778,261780,262420,262421,262423,262427,262429,262432,262693,296748,307444,368346,527996,528030,547376,547383,571777,571821,571937,805186,819008,819404,820462,836609,837033,867849,220642,249209,770774,770781,770798,770811,839488,839495,839518,888950,888950,888967,234129,248229,252310,252312,252313,252314,252315,252316,252325,252328,252329,252333,252335,252343,252344,253125,253127,253130,253133,254947,446464,847322,101349,118385,118392,153959,158091,158121,175647,209960,226790,226837,226844,226851,226868,226875,226882,237936,237937,239458,242577,242580,242581,246376,246377,246378,246379,246380,246381,246859,250446,250448,256470,259611,259615,261494,282758,282833,291491,375375,375382,420105,425841,443739,449557,449571,449922,455312,471992,546614,770330,796446,796453,796484,788274,155687,212169,212171,231486,243556,243584,254592,254593,254594,339018,453448,542388,542425,542739,247150,252499,252502,253653,253654,253656,253657,253658,253660,253663,253666,256333,259197,259198,259199,259200,259201,259243,260523,261814,268523,292146,833776,833783,833790,833806,148245,148269,148290,148306,224433,229765,229767,232093,241031,246960,246961,115720,136340,136460,136560,186513,210117,222357,222358,222359,222362,222376,222425,232075,232076,248264,248265,248266,248912,252311,252322,256781,256782,256786,262083,325998,333382,333443,358828,404143,412070,504614,536103,682657,730266,730358,730853,776707,776721,776776,776783,776813,776929,780063,814966,816281,862929,862936,862950,894555)
   AND X.TIPCODIGO = 'F'
   AND QTDEMBALAGEM > 1
   AND CGCFORNEC IN (1132613,1132613,1132613,1132613,1132613,1611823,1611823,1611823,1611823,1611823,1611823,1611823,1611823,1611823,1611823,1611823,1620550,1620550,1620550,1620550,1620550,1620550,2867469,2867469,2867469,2867469,2954467,2954467,2954467,2954467,2954467,2954467,3974724,3974724,3974724,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,1049554,1049554,1049554,1049554,1049554,1049554,2235628,2235628,2235628,2235628,2235628,2959591,2959591,2959591,2959591,2959591,2959591,2959591,2959591,2959591,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5607330,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6269104,6269104,6269104,6269104,6269104,6269104,6269104,6269104,6269104,6269104,6269104,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,11326130,11326130,11326130,11326130,11326130,16118230,16118230,16118230,16118230,16118230,16118230,16118230,16118230,16118230,16118230,16118230,16205500,16205500,16205500,16205500,16205500,16205500,28674690,28674690,28674690,28674690,29544670,29544670,29544670,29544670,29544670,29544670,39747240,39747240,39747240,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,10495545,10495545,10495545,10495545,10495545,10495545,22356280,22356280,22356280,22356280,22356280,29595914,29595914,29595914,29595914,29595914,29595914,29595914,29595914,29595914,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,46632451,46632451,46632451,46632451,46632451,46632451,46632451,46632451,46632451,46632451,46632451,46632451,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,56073307,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62691043,62691043,62691043,62691043,62691043,62691043,62691043,62691043,62691043,62691043,62691043,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506)
       ;

DECLARE
  i INTEGER := 0;
  
  BEGIN
  FOR t IN (SELECT *  
  FROM MAP_PRODCODIGO X 
 WHERE SEQPRODUTO IN (240223,240240,258925,258928,259156,125123,140706,410922,411158,434256,711807,787987,788007,837811,892599,892605,236904,236911,261117,261118,261120,261121,191135,191142,191180,707824,188647,240412,258358,361583,683135,854146,219431,253613,253615,259669,259670,259671,259672,259677,259678,259679,259680,259681,259701,259702,259709,259710,259711,259713,259714,259717,259718,259719,259720,259722,259723,259724,259725,259726,259741,259742,259744,259752,259754,259755,259762,214074,214075,214078,214079,214080,214081,261446,261448,261450,262566,262719,232138,232139,232140,232141,232142,232143,234191,239612,589444,174251,174534,189354,189361,189415,189576,206993,206994,207028,207029,207030,208692,218897,218914,223041,223043,225085,226650,227571,227572,227576,227595,227596,231559,231561,231563,245045,247978,247980,252501,253795,254045,256526,256558,256559,256572,256573,258285,258316,258317,259779,261775,261778,261780,262420,262421,262423,262427,262429,262432,262693,296748,307444,368346,527996,528030,547376,547383,571777,571821,571937,805186,819008,819404,820462,836609,837033,867849,220642,249209,770774,770781,770798,770811,839488,839495,839518,888950,888950,888967,234129,248229,252310,252312,252313,252314,252315,252316,252325,252328,252329,252333,252335,252343,252344,253125,253127,253130,253133,254947,446464,847322,101349,118385,118392,153959,158091,158121,175647,209960,226790,226837,226844,226851,226868,226875,226882,237936,237937,239458,242577,242580,242581,246376,246377,246378,246379,246380,246381,246859,250446,250448,256470,259611,259615,261494,282758,282833,291491,375375,375382,420105,425841,443739,449557,449571,449922,455312,471992,546614,770330,796446,796453,796484,788274,155687,212169,212171,231486,243556,243584,254592,254593,254594,339018,453448,542388,542425,542739,247150,252499,252502,253653,253654,253656,253657,253658,253660,253663,253666,256333,259197,259198,259199,259200,259201,259243,260523,261814,268523,292146,833776,833783,833790,833806,148245,148269,148290,148306,224433,229765,229767,232093,241031,246960,246961,115720,136340,136460,136560,186513,210117,222357,222358,222359,222362,222376,222425,232075,232076,248264,248265,248266,248912,252311,252322,256781,256782,256786,262083,325998,333382,333443,358828,404143,412070,504614,536103,682657,730266,730358,730853,776707,776721,776776,776783,776813,776929,780063,814966,816281,862929,862936,862950,894555)
   AND X.TIPCODIGO = 'F'
   AND QTDEMBALAGEM > 1
   AND CGCFORNEC IN (1132613,1132613,1132613,1132613,1132613,1611823,1611823,1611823,1611823,1611823,1611823,1611823,1611823,1611823,1611823,1611823,1620550,1620550,1620550,1620550,1620550,1620550,2867469,2867469,2867469,2867469,2954467,2954467,2954467,2954467,2954467,2954467,3974724,3974724,3974724,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,7701334,1049554,1049554,1049554,1049554,1049554,1049554,2235628,2235628,2235628,2235628,2235628,2959591,2959591,2959591,2959591,2959591,2959591,2959591,2959591,2959591,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,3031927,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4663245,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,4854151,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5572155,5607330,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6059453,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6246114,6269104,6269104,6269104,6269104,6269104,6269104,6269104,6269104,6269104,6269104,6269104,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,6280850,11326130,11326130,11326130,11326130,11326130,16118230,16118230,16118230,16118230,16118230,16118230,16118230,16118230,16118230,16118230,16118230,16205500,16205500,16205500,16205500,16205500,16205500,28674690,28674690,28674690,28674690,29544670,29544670,29544670,29544670,29544670,29544670,39747240,39747240,39747240,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,77013340,10495545,10495545,10495545,10495545,10495545,10495545,22356280,22356280,22356280,22356280,22356280,29595914,29595914,29595914,29595914,29595914,29595914,29595914,29595914,29595914,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,30319272,46632451,46632451,46632451,46632451,46632451,46632451,46632451,46632451,46632451,46632451,46632451,46632451,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,48541510,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,55721559,56073307,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,60594538,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62461140,62691043,62691043,62691043,62691043,62691043,62691043,62691043,62691043,62691043,62691043,62691043,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506,62808506)
       )
  LOOP
    BEGIN
    i := i+1;
     UPDATE CONSINCO.MAP_PRODCODIGO X SET X.QTDEMBALAGEM = 1,
                                          X.USUARIOALTERACAO = 'TKT_436061'
                                    WHERE X.SEQPRODUTO   = T.SEQPRODUTO
                                      AND X.CGCFORNEC    = T.CGCFORNEC
                                      AND X.TIPCODIGO    = T.TIPCODIGO
                                      AND X.CODACESSO    = T.CODACESSO;
                                      
                                      -- Atualiza pra subir pra iTworks
     UPDATE CONSINCO.MAP_PRODUTO Z SET Z.DTAHORALTERACAO  = SYSDATE,
                                       Z.USUARIOALTERACAO = 'TKT_436061'
                                 WHERE Z.SEQPRODUTO       = T.SEQPRODUTO;
                       
    IF i = 10 THEN COMMIT;
    i := 0;
    END IF;

    COMMIT;
    END;
    
  END LOOP;
  
  END;
